# IP协议

## 私有IP

A类：10.0.0.0-10.255.255.255

B类：172.16.0.0-172.31.255.255

C类：192.168.0.0-192.168.255.255

## 网络地址和主机地址

| 类型 | 网段数                                | 主机数             |
| ---- | ------------------------------------- | ------------------ |
| A类  | $2^{7}-2$ = 126（减去全零和回环地址） | $2^{24}-2$ =1677万 |
| B类  | $2^{14}$  =16384                      | $2^{16}-2$ = 55534 |
| C类  | $2^{21}$ = 2097152                    | $2^{8}-2$ = 254    |

## 子网掩码划分

### 原则

子网掩码必须和IP地址同时出现，否则没有意义

和子网掩码1对应的IP地址，代表网络地址；和子网掩码0对应的IP地址，代表主机地址

子网中子网掩码的1，需要是连续的

### 目的

根本目的：节约IP地址

把完整网段划分为小子网，提高IP利用率

降低成本

#### 子网掩码的简洁写法

如：192.168.1.100/24；/24代表二进制码前24位是1的子网掩码

### 默认子网掩码

| 类型 | 默认子网掩码  | 二进制 |
| ---- | ------------- | ------ |
| A类  | 255.0.0.0     | /8     |
| B类  | 255.255.0.0   | /16    |
| C类  | 255.255.255.0 | /24    |

### 子网计算公式

网络地址：把IP地址和子网掩码的二进制，按位进行逻辑与运算
广播地址：有效子网掩码中，有几个0，就把IP地址的后几位换为1
子网个数：有效子网掩码中，有几个1，子网数就是2的几次方
主机个数：有效子网掩码中，有几个0，主机数就是2的几次方减2

例如：

| 类别     | 十进制          | 二进制                                  |
| -------- | --------------- | --------------------------------------- |
| IP地址   | 192.168.1.200   | 11000000.10101000.00000001.1**1001000** |
| 子网掩码 | 255.255.255.128 | 11111111.11111111.11111111.1**0000000** |
| 网络地址 | 192.168.1.128   | 11000000.10101000.00000001.1**0000000** |
| 广播地址 | 192.168.1.255   | 11000000.10101000.00000001.1**1111111** |

子网数：$2^1=2$

主机数：$2^7-2=126$

| 类别     | 十进制          | 二进制                                  |
| -------- | --------------- | --------------------------------------- |
| IP地址   | 192.168.1.49    | 11000000.10101000.00000001.100101**01** |
| 子网掩码 | 255.255.255.252 | 11111111.11111111.11111111.111111**00** |
| 网络地址 | 192.168.1.148   | 11000000.10101000.00000001.100101**00** |
| 广播地址 | 192.168.1.151   | 11000000.10101000.00000001.100101**11** |

子网数：$2^6=264$

主机数：$2^2-2=2$

### C类地址子网划分

| 子网掩码        | 二进制数 | 子网数 | 主机数 |
| --------------- | -------- | ------ | ------ |
| 255.255.255.0   | /24      | 1      | 256-2  |
| 255.255.255.128 | /25      | 2      | 128-2  |
| 255.255.255.192 | /26      | 4      | 64-2   |
| 255.255.255.224 | /27      | 8      | 32-2   |
| 255.255.255.240 | /28      | 16     | 16-2   |
| 255.255.255.248 | /29      | 32     | 8-2    |
| 255.255.255.252 | /30      | 64     | 4-2    |

#### 注意事项

1. 私有IP地址禁止使用子网划分

2. IP地址划分只能解决需要IP数量比可用IP少的情况（在实际使用中每个子网都有一个地址需要作为网关使用）
3. 工作中的用途和例子的计算逻辑是相反的（工作中是先有IP需求，然后去租用IP，确定IP子网划分）（实际使用中基本只会碰到C类子网划分）
